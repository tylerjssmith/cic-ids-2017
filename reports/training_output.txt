scripts/train_models.sh config/train.yml
Running training pipeline with config: config/train.yml
======================================================================
Load Data
----------------------------------------------------------------------
Directory:
data/raw

Files:
Friday-WorkingHours-Afternoon-DDos.pcap_ISCX.csv
(225,745 rows, 79 columns)

Friday-WorkingHours-Afternoon-PortScan.pcap_ISCX.csv
(286,467 rows, 79 columns)

Friday-WorkingHours-Morning.pcap_ISCX.csv
(191,033 rows, 79 columns)

Monday-WorkingHours.pcap_ISCX.csv
(529,918 rows, 79 columns)

Thursday-WorkingHours-Afternoon-Infilteration.pcap_ISCX.csv
(288,602 rows, 79 columns)

Thursday-WorkingHours-Morning-WebAttacks.pcap_ISCX.csv
(170,366 rows, 79 columns)

Tuesday-WorkingHours.pcap_ISCX.csv
(445,909 rows, 79 columns)

Wednesday-workingHours.pcap_ISCX.csv
(692,703 rows, 79 columns)

Cleaned column names.

----------------------------------------------------------------------
Loaded Rows:    2,830,743
Loaded Columns: 79
Memory:         1,922.95 MB

======================================================================
Clean Data
----------------------------------------------------------------------
Dropped 1,358 rows with missing values.
Dropped 1,509 rows with infinite values.

----------------------------------------------------------------------
Rows Before: 2,830,743
Rows After:  2,827,876

======================================================================
Drop Features
----------------------------------------------------------------------
Dropped 14 named columns:
- destination_port
- fwd_header_length.1
- average_packet_size
- avg_fwd_segment_size
- avg_bwd_segment_size
- subflow_fwd_packets
- subflow_fwd_bytes
- subflow_bwd_packets
- subflow_bwd_bytes
- init_win_bytes_forward
- init_win_bytes_backward
- act_data_pkt_fwd
- min_seg_size_forward
- down_up_ratio

Dropped 8 columns with zero variance:
- bwd_psh_flags
- bwd_urg_flags
- fwd_avg_bytes_bulk
- fwd_avg_packets_bulk
- fwd_avg_bulk_rate
- bwd_avg_bytes_bulk
- bwd_avg_packets_bulk
- bwd_avg_bulk_rate

----------------------------------------------------------------------
Columns Before: 79
Columns After:  57

======================================================================
Clean Data
----------------------------------------------------------------------
Dropped 2,925 rows with negative values.

----------------------------------------------------------------------
Rows Before: 2,827,876
Rows After:  2,824,951

======================================================================
Prepare Labels
----------------------------------------------------------------------
Replaced label values:
- Web Attack � Brute Force -> web_attack
- Web Attack � Sql Injection -> web_attack
- Web Attack � XSS -> web_attack

Cleaned label values.

----------------------------------------------------------------------
Label Distribution:
_raw_label                  label           
BENIGN                      benign              2268589
Bot                         bot                    1956
DDoS                        ddos                 128006
DoS GoldenEye               dos_goldeneye         10288
DoS Hulk                    dos_hulk             229965
DoS Slowhttptest            dos_slowhttptest       5499
DoS slowloris               dos_slowloris          5796
FTP-Patator                 ftp_patator            7931
Heartbleed                  heartbleed                7
Infiltration                infiltration             35
PortScan                    portscan             158804
SSH-Patator                 ssh_patator            5895
Web Attack � Brute Force    web_attack             1507
Web Attack � Sql Injection  web_attack               21
Web Attack � XSS            web_attack              652

----------------------------------------------------------------------
Rows Before: 2,824,951
Rows After:  2,824,951

======================================================================
Split Data
----------------------------------------------------------------------
Test Size:    0.2
Random State: 76
Stratify:     True

Dataset Sizes:
Full:     2,824,951 rows
Training: 2,259,960 rows (80.0%)
Test:      564,991 rows (20.0%)

Class Balance Comparison:
----------------------------------------------------------------------
Class                  Full Dataset     Training Set         Test Set
----------------------------------------------------------------------
benign            2,268,589 (80.3%) 1,814,870 (80.3%)  453,719 (80.3%)
bot                   1,956 ( 0.1%)    1,565 ( 0.1%)      391 ( 0.1%)
ddos                128,006 ( 4.5%)  102,405 ( 4.5%)   25,601 ( 4.5%)
dos_goldeneye        10,288 ( 0.4%)    8,230 ( 0.4%)    2,058 ( 0.4%)
dos_hulk            229,965 ( 8.1%)  183,972 ( 8.1%)   45,993 ( 8.1%)
dos_slowhttptest      5,499 ( 0.2%)    4,399 ( 0.2%)    1,100 ( 0.2%)
dos_slowloris         5,796 ( 0.2%)    4,637 ( 0.2%)    1,159 ( 0.2%)
ftp_patator           7,931 ( 0.3%)    6,345 ( 0.3%)    1,586 ( 0.3%)
heartbleed                7 ( 0.0%)        6 ( 0.0%)        1 ( 0.0%)
infiltration             35 ( 0.0%)       28 ( 0.0%)        7 ( 0.0%)
portscan            158,804 ( 5.6%)  127,043 ( 5.6%)   31,761 ( 5.6%)
ssh_patator           5,895 ( 0.2%)    4,716 ( 0.2%)    1,179 ( 0.2%)
web_attack            2,180 ( 0.1%)    1,744 ( 0.1%)      436 ( 0.1%)
----------------------------------------------------------------------
Success: Class distribution differences <0.5%

======================================================================
Save Data Splits
----------------------------------------------------------------------
Directory:
data/processed

Files:
- X_train.parquet
- X_test.parquet
- y_train.parquet
- y_test.parquet

======================================================================
Train Models
----------------------------------------------------------------------
LabelEncoder():
- benign             -> 0
- bot                -> 1
- ddos               -> 2
- dos_goldeneye      -> 3
- dos_hulk           -> 4
- dos_slowhttptest   -> 5
- dos_slowloris      -> 6
- ftp_patator        -> 7
- heartbleed         -> 8
- infiltration       -> 9
- portscan           -> 10
- ssh_patator        -> 11
- web_attack         -> 12

SMOTE():
  k_neighbors reduced to 3 (min class count = 6)
- web_attack           1,744 -> 2,500
- bot                  1,565 -> 2,500
- heartbleed               6 -> 2,500
- infiltration            28 -> 2,500

----------------------------------------------------------------------
random_forest
----------------------------------------------------------------------
Weighted Average Scores (CV):
- precision: 0.9868
- recall:    0.9490
- f1_score:  0.9657

Per-Class Scores:
           class  precision  recall  f1_score  support
          benign     0.9993  0.9373    0.9673  1814870
             bot     0.0387  0.9514    0.0744     1565
            ddos     0.9987  0.9989    0.9988   102405
   dos_goldeneye     0.9955  0.9927    0.9941     8230
        dos_hulk     0.8895  0.9959    0.9397   183972
dos_slowhttptest     0.9478  0.9911    0.9690     4399
   dos_slowloris     0.9836  0.9931    0.9883     4637
     ftp_patator     0.9642  0.9976    0.9806     6345
      heartbleed     1.0000  0.8333    0.9091        6
    infiltration     0.9474  0.6429    0.7660       28
        portscan     0.9939  0.9996    0.9967   127043
     ssh_patator     0.0834  0.9824    0.1538     4716
      web_attack     0.4508  0.9031    0.6014     1744
overall_weighted     0.9868  0.9490    0.9657  2259960

SMOTE() applied for final fit:
  Samples before: 2,259,960
  Samples after:  2,266,617 (+6,657)

Feature Importances (tree-based):
                    feature  importance
total_length_of_fwd_packets      0.0445
         packet_length_mean      0.0427
      fwd_packet_length_max      0.0396
          max_packet_length      0.0385
     bwd_packet_length_mean      0.0381
      bwd_packet_length_max      0.0380
     fwd_packet_length_mean      0.0346
              bwd_packets_s      0.0307
total_length_of_bwd_packets      0.0305
          packet_length_std      0.0291

----------------------------------------------------------------------
xgboost
----------------------------------------------------------------------
Weighted Average Scores (CV):
- precision: 0.9892
- recall:    0.9888
- f1_score:  0.9887

Per-Class Scores:
           class  precision  recall  f1_score  support
          benign     0.9957  0.9904    0.9930  1814870
             bot     0.6957  0.5463    0.6120     1565
            ddos     0.9988  0.9987    0.9987   102405
   dos_goldeneye     0.9936  0.9927    0.9931     8230
        dos_hulk     0.9190  0.9769    0.9470   183972
dos_slowhttptest     0.9481  0.9891    0.9682     4399
   dos_slowloris     0.9957  0.9925    0.9941     4637
     ftp_patator     0.9965  0.9838    0.9901     6345
      heartbleed     0.8333  0.8333    0.8333        6
    infiltration     0.9524  0.7143    0.8163       28
        portscan     0.9939  0.9996    0.9967   127043
     ssh_patator     0.9996  0.5038    0.6700     4716
      web_attack     0.9918  0.9014    0.9444     1744
overall_weighted     0.9892  0.9888    0.9887  2259960

SMOTE() applied for final fit:
  Samples before: 2,259,960
  Samples after:  2,266,617 (+6,657)

Feature Importances (tree-based):
                    feature  importance
                  idle_mean      0.1024
      bwd_packet_length_std      0.0966
                fwd_iat_std      0.0778
              bwd_packets_s      0.0624
      bwd_packet_length_min      0.0576
     bwd_packet_length_mean      0.0561
             psh_flag_count      0.0490
total_length_of_fwd_packets      0.0468
               flow_bytes_s      0.0380
     packet_length_variance      0.0365

----------------------------------------------------------------------
Results saved:
models/results.pkl

Pipeline complete.
